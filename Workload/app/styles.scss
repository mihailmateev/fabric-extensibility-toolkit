/**
 * ============================================================================
 * Fabric Extensibility Toolkit - Global Styles
 * ============================================================================
 * 
 * This stylesheet follows Microsoft Fabric UX System guidelines:
 * 
 * ## Design Tokens
 * - Colors: Use var(--color*) tokens for consistent theming
 * - Spacing: Use var(--spacing*) tokens (XS: 4px, S: 8px, M: 12px, L: 16px, XL: 24px, XXL: 32px)
 * - Typography: Use var(--fontSize*) and var(--fontWeight*) tokens
 * - Border Radius: Use var(--borderRadius*) tokens
 * - Shadows: Use var(--shadow*) tokens for elevation
 * 
 * ## Accessibility
 * - Minimum touch target size: 32px x 32px
 * - Color contrast ratios: WCAG 2.1 AA compliant
 * - Keyboard navigation support
 * - Screen reader compatibility
 * 
 * ## Component Guidelines
 * - Buttons: Use Fluent UI Button component with proper appearance variants
 * - Toolbars: Always wrap ToolbarButton in Tooltip for accessibility
 * - Inputs: Use Field component for proper label-input association
 * - Dialogs: Follow standard dialog pattern with header, body, footer
 * 
 * ## SCSS Architecture Strategy (Three-Tier Approach)
 * 
 * This project uses a three-tier SCSS architecture for maintainability and scalability:
 * 
 * ### 1. Global Styles (THIS FILE - styles.scss)
 * **Location**: `Workload/app/styles.scss`
 * **Purpose**: Shared styles used across ALL components and items
 * **Contains**:
 *   - BaseItemEditor layout (ribbon, notification, content) - used by ALL items
 *   - Common ribbon and toolbar styles
 *   - Empty state components (BaseItemEditorEmpty)
 *   - Settings panel containers (generic, neutral styling)
 * **When to use**: Styles that are shared by 2+ components or items
 * **Import pattern**: `import "../../styles.scss"`
 * **Examples**: 
 *   - `.item-editor-container` (used by BaseItemEditor - ALL items use this)
 *   - `.ribbon-container` (standard ribbon layout)
 *   - `.item-settings-panel-container` (generic settings panel)
 * 
 * ### 2. Item-Specific Styles (Item SCSS files) - MOST COMMON
 * **Location**: Next to item (e.g., `items/HelloWorldItem/HelloWorldItem.scss`)
 * **Purpose**: Unique styling for specific workload items
 * **Contains**:
 *   - Item-branded colors and typography
 *   - Custom layouts for item views (getting started, detail pages)
 *   - Item-specific UI patterns
 * **When to use**: Styling is unique to this item and not reused elsewhere
 * **Import pattern**: `import "./ItemName.scss"`
 * **Naming convention**: Prefix all classes with item name (e.g., `.hello-world-*`)
 * **Examples**: 
 *   - HelloWorldItem.scss: Branded gradient backgrounds and custom card layouts
 *   - HelloWorldItem.scss: `.hello-world-settings-panel-container` (overrides generic with green theme)
 * 
 * **IMPORTANT**: Every item editor MUST have its own SCSS file for item-specific styling.
 * The basic layout (ribbon, editor container, notification area) comes from styles.scss,
 * but item-specific views, colors, and custom components go in the item's SCSS file.
 * 
 * ### 3. Component-Specific Styles (Component SCSS files) - RARE
 * **Location**: Next to component (e.g., `samples/views/SampleOneLakeItemExplorer.scss`)
 * **Purpose**: Layout and structure for specialized reusable components
 * **Contains**:
 *   - Component-specific layout (BEM naming: `.component-name__*`)
 *   - Responsive design patterns for the component
 *   - Complex component-specific UI patterns
 * **When to use**: Component has complex layout/structure needs AND is reused across items
 * **Import pattern**: `import "./ComponentName.scss"`
 * **Examples**: 
 *   - SampleOneLakeItemExplorer.scss: Complex explorer view with tree navigation
 *   - Custom data grid components with specialized layouts
 * 
 * **NOTE**: BaseItemEditor does NOT have its own SCSS file because its styles are in 
 * styles.scss (tier 1) since ALL items use it. Only create component SCSS for specialized
 * components that aren't universal.
 * 
 * ### Decision Guide: Where Should My Styles Go?
 * 
 * ```
 * Is the style used by ALL items/components?
 * ├─ YES → Add to styles.scss (Global - Tier 1)
 * │        Examples: .item-editor-container (BaseItemEditor), .ribbon-container, .item-settings-panel-container
 * │
 * └─ NO → Is it specific to one item?
 *    ├─ YES → Create/add to ItemName.scss (Item-Specific - Tier 2) ← MOST COMMON
 *    │        REQUIRED for every item editor!
 *    │        Examples: .hello-world-*, .my-item-*
 *    │
 *    └─ NO → Create/add to ComponentName.scss (Component-Specific - Tier 3) ← RARE
 *             Only for specialized reusable components (not BaseItemEditor)
 *             Examples: SampleOneLakeItemExplorer.scss, CustomDataGrid.scss
 * ```
 * 
 * ### For Item Editors Specifically
 * 
 * **Every item editor MUST follow this pattern:**
 * 
 * 1. **Use BaseItemEditor component** (provides .item-editor-container layout from global styles.scss)
 * 2. **Create ItemName.scss** for your item-specific styling:
 *    - Item views: getting started, default, detail pages, settings
 *    - Custom colors and branding (override generic styles)
 *    - Item-specific components
 * 3. **Import ItemName.scss** in your item's view components
 * 4. **Prefix all classes** with your item name (e.g., .hello-world-getting-started)
 * 
 * **Example Structure:**
 * ```
 * items/HelloWorldItem/
 * ├── HelloWorldItem.scss              ← Item-specific styles (TIER 2 - REQUIRED)
 * ├── HelloWorldItemEditor.tsx         ← Uses BaseItemEditor (gets layout from TIER 1)
 * ├── HelloWorldItemEditorDefault.tsx  ← Imports HelloWorldItem.scss
 * └── HelloWorldItemEditorEmpty.tsx    ← Imports HelloWorldItem.scss
 * ```
 * 
 * ### Benefits of This Architecture
 * - **Maintainability**: Clear ownership of styles (no guessing where to add/edit)
 * - **Scalability**: New items get their own SCSS without polluting global styles
 * - **Performance**: Only import what you need (component/item specific)
 * - **Consistency**: Global styles ensure consistent UX patterns
 * - **Modularity**: Components are self-contained with their styles
 * 
 * ## References
 * - Fluent UI v9: https://react.fluentui.dev/
 * - Fabric Design Tokens: https://aka.ms/fabric-tokens
 * - Accessibility Guidelines: https://www.w3.org/WAI/WCAG21/quickref/
 * - BEM Methodology: https://getbem.com/
 */

// ============================================================================
// Item Editor Layout - Used by BaseItemEditor component (shared by all items)
// ============================================================================

/**
 * Provides a consistent layout for all item editors following Fabric UX guidelines:
 * - Fixed ribbon at the top (always visible)
 * - Optional notification area (fixed, not scrolled)
 * - Scrollable content area (fills remaining space)
 * - Full height to fill iframe
 * 
 * This is a foundational component used by ALL items, hence in global styles.
 * 
 * ## Item-Specific Styling Guidelines
 * Each item editor should have its own SCSS file (e.g., HelloWorldItem.scss) for:
 * - Item-specific view layouts (getting started, detail pages, settings)
 * - Custom colors, branding, and typography
 * - Item-specific components and UI patterns
 * 
 * The base layout (.item-editor-container, .item-editor-container__ribbon, etc.) is provided here.
 * Import this file via BaseItemEditor component, and create your item SCSS for custom styling.
 */
.item-editor-container {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100vh; // Fill entire viewport/iframe height
  background: var(--colorNeutralBackground2, #f3f2f1);
  overflow: hidden; // Prevent outer scroll

  // Ribbon Container - Fixed at the top
  &__ribbon {
    flex-shrink: 0; // Don't shrink the ribbon
    padding: var(--spacingVerticalS, 8px) var(--spacingHorizontalS, 8px) 0 var(--spacingHorizontalS, 8px);
    background: var(--colorNeutralBackground2, #f3f2f1);
    z-index: 1; // Keep ribbon above content during scroll
  }

  // Notification Area (Optional) - Fixed below the ribbon
  &__notification {
    flex-shrink: 0; // Don't shrink the notification area
    padding: 0 var(--spacingHorizontalS, 8px);
    background: var(--colorNeutralBackground2, #f3f2f1);
    z-index: 1; // Keep notification above content during scroll
  }

  // Content Area - Fills remaining space and scrolls independently
  &__content {
    flex: 1; // Take all remaining space
    overflow-y: auto; // Allow vertical scrolling
    overflow-x: hidden; // Prevent horizontal scroll
    padding: var(--spacingVerticalS, 8px);
    background: var(--colorNeutralBackground2, #f3f2f1);

    // Custom scrollbar styling - Fabric UX guideline
    &::-webkit-scrollbar {
      width: 8px;
    }

    &::-webkit-scrollbar-track {
      background: transparent;
    }

    &::-webkit-scrollbar-thumb {
      background: var(--colorNeutralStroke1, #d1d1d1);
      border-radius: var(--borderRadiusMedium, 4px);
      
      &:hover {
        background: var(--colorNeutralStroke1Hover, #b3b3b3);
      }
    }
  }

  // Focus management for accessibility
  &:focus-within {
    outline: none;
  }

  // Skip to content link support
  &__content:focus {
    outline: 2px solid var(--colorCompoundBrandStroke, #0078d4);
    outline-offset: -2px;
  }
}

// Responsive adjustments for item editor
@media (max-width: 768px) {
  .item-editor-container {
    &__ribbon {
      padding: var(--spacingVerticalXS, 4px) var(--spacingHorizontalXS, 4px) 0 var(--spacingHorizontalXS, 4px);
    }

    &__notification {
      padding: 0 var(--spacingHorizontalXS, 4px);
    }

    &__content {
      padding: var(--spacingVerticalXS, 4px);
    }
  }
}

// High contrast mode support for item editor
@media (prefers-contrast: high) {
  .item-editor-container {
    &__ribbon,
    &__notification,
    &__content {
      border: 1px solid transparent; // Will be visible in high contrast mode
    }
  }
}

// ============================================================================
// Ribbon Styles - Shared across items
// ============================================================================

.ribbon-container .toolbarContainer {
    // Fabric UX guideline: Use appropriate height for touch targets (minimum 32px)
    min-height: 40px;
    height: auto; // Allow flexible height for content
    border-radius: var(--borderRadiusMedium, 4px); // Use Fabric design tokens
    background: var(--colorNeutralBackground1, #ffffff);
    box-shadow: var(--shadow4, 0 0 2px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.14));
    margin: 5px 0;
    padding: 4px 8px; // Add padding for content spacing
    display: flex;
    align-items: center;
    gap: 4px; // Spacing between toolbar items
}

.ribbon-container button[role="tab"] {
    // Fabric UX guideline: Tabs should have adequate padding for accessibility
    padding: 8px 12px;
    min-height: 32px; // Ensure minimum touch target size
    display: flex;
    align-items: center;
    justify-content: center;
}

// ============================================================================
// Empty State Styles - Used in BaseItemEditorEmpty component
// ============================================================================

.item-editor-empty-state-container {
  width: 100%;
  height: 100%;
  background: var(--colorNeutralBackground1, #ffffff);
  box-shadow: var(--shadow4, 0 0 2px rgba(0, 0, 0, 0.12), 0 2px 4px rgba(0, 0, 0, 0.14));
  overflow: hidden;
  border-radius: var(--borderRadiusMedium, 4px);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: var(--spacingVerticalXL, 24px);

  .empty-state-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacingVerticalXL, 24px);
    max-width: 600px; // Default max-width, can be overridden via inline style

    .empty-state-image {
      width: 200px;
      height: 200px;
      max-width: 100%; // Responsive
      height: auto;
      object-fit: contain;
    }

    .empty-state-text-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacingVerticalS, 8px);
      text-align: center;
      padding: 0 var(--spacingHorizontalXL, 24px);

      .empty-state-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: var(--spacingVerticalS, 8px);

        h2 {
          color: var(--colorNeutralForeground1, #242424);
          font-size: var(--fontSizeBase500, 20px);
          font-family: var(--fontFamilyBase, 'Segoe UI', sans-serif);
          font-weight: var(--fontWeightSemibold, 600);
          line-height: var(--lineHeightBase500, 28px);
          margin: 0;
          padding: 0;
        }

        .empty-state-description {
          color: var(--colorNeutralForeground2, #424242);
          font-size: var(--fontSizeBase300, 14px);
          font-family: var(--fontFamilyBase, 'Segoe UI', sans-serif);
          font-weight: var(--fontWeightRegular, 400);
          line-height: var(--lineHeightBase300, 20px);
          margin: 0;
          padding: 0;
          max-width: 500px;
        }
      }
    }
  }
}

// Responsive adjustments for empty state
@media (max-width: 768px) {
  .item-editor-empty-state-container {
    padding: var(--spacingVerticalL, 16px);

    .empty-state-content {
      .empty-state-image {
        width: 150px;
        height: 150px;
      }

      .empty-state-text-container {
        padding: 0 var(--spacingHorizontalL, 16px);

        .empty-state-header {
          h2 {
            font-size: var(--fontSizeBase400, 16px);
            line-height: var(--lineHeightBase400, 22px);
          }

          .empty-state-description {
            font-size: var(--fontSizeBase200, 12px);
            line-height: var(--lineHeightBase200, 16px);
          }
        }
      }
    }
  }
}

// ============================================================================
// Settings Panel Styles - Generic UX System Compliant
// ============================================================================

/**
 * Generic settings panel container following Fabric UX System guidelines.
 * 
 * This provides a neutral, accessible container for settings pages that follows
 * Microsoft Fabric design patterns.
 * 
 * ## Design Principles
 * - Uses neutral colors (not branded) for universal applicability
 * - Follows standard card pattern with subtle elevation
 * - Accessible with proper contrast ratios
 * - Responsive and flexible for various content types
 * 
 * ## Usage
 * Use this for standard settings panels that don't require item-specific branding.
 * For item-specific branding (like HelloWorld's green theme), create item-specific
 * styles in your ItemName.scss file.
 * 
 * ## Example
 * ```tsx
 * <div className="item-settings-panel-container">
 *   <div className="item-settings-panel-content">
 *     // Your settings content here
 *   </div>
 * </div>
 * ```
 * 
 * ## Item-Specific Overrides
 * The HelloWorld item demonstrates custom branding in HelloWorldItem.scss:
 * - .hello-world-settings-panel-container (with branded green colors)
 * 
 * Other items can follow the same pattern for their own branding.
 */
.item-settings-panel-container {
  width: 100%;
  height: 100%;
  background: var(--colorNeutralBackground1);
  overflow: hidden;
  border-radius: var(--borderRadiusMedium);
  box-shadow: var(--shadow4);
  display: flex;
  flex-direction: column;

  .item-settings-panel-content {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    padding: var(--spacingVerticalXL);
    overflow-y: auto;
    overflow-x: hidden;

    // Custom scrollbar styling - consistent with item editor
    &::-webkit-scrollbar {
      width: 8px;
    }

    &::-webkit-scrollbar-track {
      background: transparent;
    }

    &::-webkit-scrollbar-thumb {
      background: var(--colorNeutralStroke1);
      border-radius: var(--borderRadiusMedium);
      
      &:hover {
        background: var(--colorNeutralStroke1Hover);
      }
    }
  }

  // Settings section header
  .item-settings-section-header {
    color: var(--colorNeutralForeground1);
    font-size: var(--fontSizeBase500);
    font-family: var(--fontFamilyBase);
    font-weight: var(--fontWeightSemibold);
    line-height: var(--lineHeightBase500);
    margin: 0 0 var(--spacingVerticalM) 0;
    padding: 0;
  }

  // Settings section description
  .item-settings-section-description {
    color: var(--colorNeutralForeground2);
    font-size: var(--fontSizeBase300);
    font-family: var(--fontFamilyBase);
    font-weight: var(--fontWeightRegular);
    line-height: var(--lineHeightBase300);
    margin: 0 0 var(--spacingVerticalL) 0;
    padding: 0;
  }

  // Settings form field group
  .item-settings-field-group {
    display: flex;
    flex-direction: column;
    gap: var(--spacingVerticalM);
    margin-bottom: var(--spacingVerticalXL);
  }

  // Settings placeholder (for empty settings pages)
  .item-settings-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: var(--spacingVerticalXXXL);
    height: 100%;

    .item-settings-placeholder-text {
      color: var(--colorNeutralForeground2);
      font-size: var(--fontSizeBase400);
      font-family: var(--fontFamilyBase);
      font-weight: var(--fontWeightRegular);
      line-height: var(--lineHeightBase400);
      max-width: 600px;
    }
  }
}

// Responsive adjustments for settings panel
@media (max-width: 768px) {
  .item-settings-panel-container {
    .item-settings-panel-content {
      padding: var(--spacingVerticalL);
    }

    .item-settings-section-header {
      font-size: var(--fontSizeBase400);
      line-height: var(--lineHeightBase400);
    }

    .item-settings-section-description {
      font-size: var(--fontSizeBase200);
      line-height: var(--lineHeightBase200);
    }

    .item-settings-placeholder {
      padding: var(--spacingVerticalXL);

      .item-settings-placeholder-text {
        font-size: var(--fontSizeBase300);
        line-height: var(--lineHeightBase300);
      }
    }
  }
}

// High contrast mode support
@media (prefers-contrast: high) {
  .item-settings-panel-container {
    border: 1px solid transparent; // Will be visible in high contrast mode

    .item-settings-section-header,
    .item-settings-section-description,
    .item-settings-placeholder-text {
      border: 1px solid transparent;
    }
  }
}

// ============================================================================
// Loading Progress Styles - Standard Fabric UX System Pattern
// ============================================================================

/**
 * Loading progress indicator following Fabric UX System guidelines.
 * 
 * This provides a standard indeterminate progress indicator for loading states
 * that follows Microsoft Fabric design patterns.
 * 
 * ## Design Principles
 * - Indeterminate state for unknown duration operations
 * - Non-blocking interaction pattern
 * - Accessible with proper ARIA support
 * - Centered layout for full-page loading states
 * 
 * ## Usage
 * Use this for item editor loading states and other long-running operations.
 * 
 * ## Example
 * ```tsx
 * <div className="item-editor-loading-container" role="progressbar" aria-label="Loading..." aria-busy="true">
 *   <div className="item-editor-loading-icon">
 *     <img src="/assets/icon.png" alt="" />
 *   </div>
 *   <div className="item-editor-loading-text">Loading item...</div>
 *   <div className="item-editor-loading-progress">
 *     <div className="item-editor-loading-progress-fill"></div>
 *   </div>
 * </div>
 * ```
 */
.item-editor-loading-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  gap: var(--spacingVerticalXL);
  background-color: var(--colorNeutralBackground2);
}

.item-editor-loading-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: var(--spacingVerticalM);

  img {
    width: 48px;
    height: 48px;
    object-fit: contain;
  }

  // Support for Fluent UI icon components (rendered as SVG or span)
  svg, span {
    width: 48px;
    height: 48px;
  }
}

.item-editor-loading-text {
  font-size: var(--fontSizeBase400);
  font-weight: var(--fontWeightSemibold);
  color: var(--colorNeutralForeground1);
  font-family: var(--fontFamilyBase);
  line-height: var(--lineHeightBase400);
}

.item-editor-loading-progress {
  width: 300px;
  height: 4px;
  background-color: var(--colorNeutralBackground5);
  border-radius: var(--borderRadiusMedium);
  overflow: hidden;
  position: relative;
}

.item-editor-loading-progress-fill {
  height: 100%;
  background-color: var(--colorBrandBackground);
  width: 30%;
  position: absolute;
  animation: progress-indeterminate 2s ease-in-out infinite;
}

// Indeterminate progress animation
@keyframes progress-indeterminate {
  0% {
    left: -30%;
  }
  100% {
    left: 100%;
  }
}

// Responsive adjustments for loading progress
@media (max-width: 768px) {
  .item-editor-loading-container {
    gap: var(--spacingVerticalL);
  }

  .item-editor-loading-icon {
    img, svg, span {
      width: 40px;
      height: 40px;
    }
  }

  .item-editor-loading-text {
    font-size: var(--fontSizeBase300);
    line-height: var(--lineHeightBase300);
  }

  .item-editor-loading-progress {
    width: 240px;
  }
}

// High contrast mode support
@media (prefers-contrast: high) {
  .item-editor-loading-container {
    border: 1px solid transparent; // Will be visible in high contrast mode
  }

  .item-editor-loading-progress {
    border: 1px solid transparent;
  }

  .item-editor-loading-progress-fill {
    border: 1px solid transparent;
  }
}